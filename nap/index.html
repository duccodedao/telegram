<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Mua Coin</title>
    <style>
        /* Đặt chung cho toàn bộ trang */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7fb;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* Định dạng khung form */
        form {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            box-sizing: border-box;
        }

        /* Tiêu đề form */
        form h2 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        /* Định dạng các input và select */
        input[type="number"], input[type="text"], select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        input[type="number"]:focus, input[type="text"]:focus, select:focus {
            border-color: #007bff;
            outline: none;
        }

        /* Định dạng nút */
        button {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Định dạng các nút riêng biệt */
        #openWalletButton {
            background-color: #28a745;
            display: none;
        }

        #openWalletButton:hover {
            background-color: #218838;
        }

        /* Định dạng các thông báo lỗi */
        .swal2-popup {
            font-size: 16px;
            border-radius: 8px;
            padding: 20px;
            box-sizing: border-box;
        }

        label {
            font-weight: bold;
            color: #333;
        }

        /* Cải tiến giao diện cho thông báo dán địa chỉ ví */
        #pasteButton {
            background-color: #ffc107;
            border: none;
            padding: 10px;
            border-radius: 4px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: 100%;
            margin-top: 10px;
            display: none;
        }

        #pasteButton:hover {
            background-color: #e0a800;
        }

        /* Định dạng các tiêu đề và mô tả trong form */
        h3 {
            color: #007bff;
            margin-top: 20px;
            text-align: center;
        }

        #orderForm {
            padding-bottom: 20px;
        }

        button:disabled {
            background-color: #ddd;
            cursor: not-allowed;
        }

        /* Thêm không gian giữa các phần tử */
        input[type="text"], input[type="number"], select {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <form id="orderForm">
        <h2>Form Mua Coin</h2>
        <label for="coin">Chọn Coin:</label>
        <select id="coin">
            <option value="" disabled selected>Chọn Coin</option>
            <option value="TON">TON</option>
            <option value="SOL">SOL</option>
            <option value="NEAR">NEAR</option>
            <option value="BNB">BNB</option>
            <option value="ETH">ETH</option>
            <option value="SUI">SUI</option>
            <option value="MATIC">MATIC</option>
        </select>

        <label for="network">Chọn Mạng:</label>
        <select id="network">
            <option value="" disabled selected>Chọn mạng</option>
        </select>

        <label for="quantity">Số lượng:</label>
        <input type="number" id="quantity" min="0" step="0.001">

        <label for="address">Địa chỉ ví:</label>
        <input type="text" id="address">

        <label for="memoOption">Memo:</label>
        <select id="memoOption">
            <option value="none">Không có</option>
            <option value="input">Nhập memo</option>
        </select>
        <input type="text" id="memo" disabled>

        <button type="button" id="openWalletButton">Mở ví</button>

        <button type="button" id="pasteButton">Dán địa chỉ ví</button>

        <button type="submit" id="purchaseButton" disabled>Mua</button>
    </form>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const coinSelect = document.getElementById('coin');
            const networkSelect = document.getElementById('network');
            const quantityInput = document.getElementById('quantity');
            const addressInput = document.getElementById('address');
            const memoOptionSelect = document.getElementById('memoOption');
            const memoInput = document.getElementById('memo');
            const purchaseButton = document.getElementById('purchaseButton');

            // Set default values
            coinSelect.value = '';
            networkSelect.innerHTML = '<option value="" disabled selected>Không</option>';
            quantityInput.value = 0;
            updateButtonText(); // Initialize button text

            coinSelect.addEventListener('change', function () {
                networkSelect.innerHTML = '<option value="" disabled selected>Chọn mạng</option>'; // Clear current options
                
                switch (this.value) {
                    case 'TON':
                        networkSelect.innerHTML += '<option value="TON">TON</option>';
                        quantityInput.placeholder = '0.1 - 9.5';
                        quantityInput.min = 0.1;
                        quantityInput.max = 9.5;
                        quantityInput.step = 0.001;
                        break;
                    case 'SOL':
                        networkSelect.innerHTML += '<option value="spl">SOLANA</option>';
                        quantityInput.placeholder = '0.01 - 0.4';
                        quantityInput.min = 0.01;
                        quantityInput.max = 0.4;
                        quantityInput.step = 0.001;
                        break;
                    case 'NEAR':
                        networkSelect.innerHTML += '<option value="near">NEAR</option>';
                        quantityInput.placeholder = '0.2 - 20';
                        quantityInput.min = 0.2;
                        quantityInput.max = 20;
                        quantityInput.step = 0.001;
                        break;
                    case 'BNB':
                        networkSelect.innerHTML += '<option value="bep20">BSC (BEP20)</option>';
                        quantityInput.placeholder = '0.01 - 0.12';
                        quantityInput.min = 0.01;
                        quantityInput.max = 0.12;
                        quantityInput.step = 0.001;
                        break;
                    case 'ETH':
                        networkSelect.innerHTML += '<option value="arb">ARBITRUM</option><option value="ancient8">ANCIENT 8</option><option value="base">BASE</option>';
                        quantityInput.placeholder = '0.001 - 0.02';
                        quantityInput.min = 0.001;
                        quantityInput.max = 0.02;
                        quantityInput.step = 0.001;
                        break;
                    case 'SUI':
                        networkSelect.innerHTML += '<option value="sui">SUI</option>';
                        quantityInput.placeholder = '0.25 - 40';
                        quantityInput.min = 0.25;
                        quantityInput.max = 40;
                        quantityInput.step = 0.001;
                        break;
                    case 'MATIC':
                        networkSelect.innerHTML += '<option value="prc20">POLYGON</option>';
                        quantityInput.placeholder = '1 - 125';
                        quantityInput.min = 1;
                        quantityInput.max = 125;
                        quantityInput.step = 0.001;
                        break;
                    default:
                        quantityInput.placeholder = '';
                        quantityInput.min = 0;
                        quantityInput.max = 0;
                        quantityInput.step = 0;
                        break;
                }
                
                updateButtonText(); // Update button text based on new coin selection
            });

            quantityInput.addEventListener('input', updateButtonText);
            networkSelect.addEventListener('change', updateButtonText);

            function updateButtonText() {
                const coin = coinSelect.value;
                const quantity = quantityInput.value;
                if (quantity && coin) {
                    purchaseButton.textContent = `Mua ${quantity} ${coin}`;
                    purchaseButton.disabled = false; // Enable button when valid selection is made
                } else {
                    purchaseButton.textContent = `Mua`;
                    purchaseButton.disabled = true;
                }
            }

            // Handle paste button click
            document.getElementById('pasteButton').addEventListener('click', function () {
                navigator.clipboard.readText().then(text => {
                    addressInput.value = text;
                }).catch(err => {
                    console.error('Failed to read clipboard contents: ', err);
                });
            });

            // Handle memo option change
            memoOptionSelect.addEventListener('change', function () {
                if (this.value === 'input') {
                    memoInput.disabled = false;
                } else {
                    memoInput.disabled = true;
                    memoInput.value = '';
                }
            });

            // Handle form submission
            document.getElementById('orderForm').addEventListener('submit', function (event) {
                event.preventDefault();

                const coin = coinSelect.value;
                const network = networkSelect.value;
                const quantity = quantityInput.value;
                const address = addressInput.value;
                const memoOption = memoOptionSelect.value;
                const memo = memoOption === 'input' ? memoInput.value : '';

                const url = `https://aliniex.com/orders?items=${coin}&amounts=${quantity}&wallet_address=${address}&network=${network}&memo=${memo}&referral_code=GEmVdVbzWp&redirect_to=`;

                Swal.fire({
                    title: 'Xác nhận mua',
                    html: `Bạn có chắc chắn muốn mua <strong>${quantity} ${coin}</strong>?`,
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'Xác nhận',
                    cancelButtonText: 'Hủy',
                }).then(result => {
                    if (result.isConfirmed) {
                        window.location.href = url; // Redirect to the payment URL
                    }
                });
            });
        });
    </script>
</body>
</html>
